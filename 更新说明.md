# 更新说明（2026年2月6日）

## ✅ 已完成的工作

### 0. 命令行与使用文档（v2.0 新增）

#### 推理周期
- `--timeframe h1`（默认）：1 小时 K 线推理
- `--timeframe 4h`：4 小时 K 线推理
- `--timeframe d1`：日线推理

#### 时间范围推理
- `--from "2026-01-22 16:00:00"`：指定起始时间
- `--to "2026-02-01 12:00:00"`：指定结束时间（可选）
- `--range "起" "止"`：时间范围简写

#### 波浪点位模式
- `--wave`：识别推动浪 1-2-3-4-5 和调整浪 a-b-c
- 支持 `--timeframe` 和 `--from`/`--to` 组合

### 1. 推理文档更新
- ✅ 更新为基于**5600为第一浪结束，当前第二浪进行中**的新逻辑
- ✅ 添加了基于图片的最新浪型结构分析
- ✅ 更新了关键点位和监测点
- ✅ 添加了蓝线0.8位置（4540）作为生命线

### 2. 脚本功能更新

#### 新增功能
- ✅ **1小时K线数据获取**：支持获取前30天的每小时收盘价
- ✅ **本地数据存储**：自动保存K线数据到 `gold_price_1h.json`
- ✅ **数据自动更新**：每小时自动更新数据（如果本地数据超过1小时）
- ✅ **多数据源支持**：优先使用K线数据，其次使用API

#### 更新功能
- ✅ **波浪结构分析**：更新为基于新结构的 `analyzeWave2()` 函数
- ✅ **趋势判断**：更新为适配新结构的 `judgeTrend()` 函数
- ✅ **输出格式**：更新为显示新波浪结构的分析结果
- ✅ **关键点位**：更新为基于第一浪5600和第二浪的关键点位

### 3. 关键点位更新

#### 第一浪
- 起点：4300（0点）
- 终点：5600（V）
- 涨幅：1300

#### 第二浪关键点位
- **生命线（最重要）**：4540（蓝线0.8位置）
- Y浪低点：4600
- 上升5浪(iv)浪低点：4850
- 上升5浪(v)浪高点：5150（突破则进入第三浪）

#### 黄金分割回撤位（基于第一浪5600）
- 0.236回撤：5293
- 0.382回撤：5103
- 0.5回撤：4950
- 0.618回撤：4797
- 0.786回撤：4778
- **0.8回撤（蓝线）**：**4540** ⭐

## 📁 文件结构

```
A波浪/
├── 黄金波浪理论推理文档/      # 推理文档（已拆分为多文件）
├── goldWaveAnalysis.js        # 更新的分析脚本
├── gold_price_1h.json         # 1小时K线数据（自动生成）
├── package.json               # 项目配置
├── README.md                  # 使用说明
├── 使用示例.md                # 使用示例
└── 更新说明.md                # 本文件
```

## 🚀 使用方法

### 基本使用
```bash
# 单次分析（手动价格）
node goldWaveAnalysis.js --price 4823.525

# 使用K线数据（自动获取最新价格）
node goldWaveAnalysis.js

# 定时监控（每5分钟）
node goldWaveAnalysis.js --watch
```

### 多周期推理
```bash
# 4 小时推理
node goldWaveAnalysis.js --price 4820 --timeframe 4h

# 日线推理
node goldWaveAnalysis.js --price 4820 --timeframe d1
```

### 时间范围推理
```bash
# 指定时间范围
node goldWaveAnalysis.js --price 4820 --from "2025-06-01 00:00:00" --to "2026-01-15 23:59:59"
```

### 数据管理
- K线数据自动保存在 `gold_price_1h.json`
- 数据每小时自动更新
- 如果API不可用，会使用模拟数据（用于测试）

## 📊 输出示例

脚本会输出：
1. **当前价格**：从K线数据或API获取
2. **波浪结构**：第一浪和第二浪的结构
3. **趋势状态**：基于新结构的趋势判断
4. **监测点状态**：生命线、Y浪低点、上升5浪关键点
5. **关键点位列表**：支撑位和压力位（按价格排序）
6. **黄金分割计算**：回撤位和反弹位
7. **数据统计**：K线数据条数和时间范围

## ⚠️ 注意事项

1. **API配置**：当前使用模拟数据，实际使用时需要配置真实的OANDA API或其他数据源
2. **数据准确性**：确保K线数据的时间戳和价格准确
3. **生命线4540**：这是最重要的支撑位，跌破需要重新评估浪型
4. **第三浪目标**：如果第二浪在4540-4600结束，第三浪目标约6600-6800（1.618倍）或7900-8200（2.618倍）

## 🔄 后续改进建议

1. **API集成**：集成真实的OANDA API或其他黄金价格API
2. **数据验证**：添加数据完整性检查
3. **图表生成**：可选功能，生成K线图表
4. **历史回测**：基于历史数据回测波浪理论准确性
5. **多时间周期**：支持日线、4小时线等多时间周期分析
